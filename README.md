# streamdle song scraper

<details>
  <summary>Table of Contents</summary>
    <li><a href="#overview">Overview</a></li>
    <li>
      <a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#installation">Installation</a></li>
      </ul>
    </li>
    <li><a href="#usage">Usage</a></li>
    <li><a href="#license">License</a></li>
    <li><a href="#contact">Contact</a></li>
</details>

## Overview

This Python script scrapes popular Spotify artist and song data from [kworb.net](https://kworb.net) and updates a PostgreSQL database, utilized by the [streamdle](https://github.com/ct0ng/streamdle) app. 

## Getting Started
### Prerequisites
- Python 3.x
- A PostgreSQL database
- Dependencies listed in `requirements.txt`

### Installation
1. Set up PostgreSQL database  
  You can set up a local PostgreSQL database by installing [PostgreSQL](https://www.postgresql.org/download/) on your operating system and creating a new database.  
  Alternatively, you can create a project through [Supabase](https://supabase.com/), a platform that is built on top of PostgreSQL that doesn't require local setup and maintenance
  To set up the database schema, run the following SQL commands in the SQL editor :
```
create table public.artist (
  artist_id serial not null,
  name text not null,
  spotify_id text null,
  constraint artist_pkey primary key (artist_id),
  constraint artist_name_key unique (name),
  constraint artist_spotify_id_key unique (spotify_id)
) TABLESPACE pg_default;

create table public.song (
  song_id bigint generated by default as identity not null,
  title text not null,
  stream_count bigint not null,
  created_datetime timestamp without time zone not null default now(),
  updated_datetime timestamp without time zone null,
  artist_id integer null,
  constraint song_pkey primary key (song_id),
  constraint song_title_artist_id_key unique (title, artist_id),
  constraint fk_artist foreign KEY (artist_id) references artist (artist_id)
) TABLESPACE pg_default;
```
//TODO: add info for function to get random songs
2. Clone the repo
```sh
  git clone https://github.com/ct0ng/streamdle-song-scraper.git
```
3. Install Python Dependencies
```
  pip install -r requirements.txt
```
4. Add Environment Variables  
   Create an `.env` file in the root directory of the project that will store your PostgreSQL database credentials. The file should look something like:
```
DB_HOST=your-db-host.supabase.co
DB_NAME=your_database_name
DB_PORT=5432
DB_USER=your_db_user
DB_PASSWORD=your_db_password
```

## Usage
To run the script:
1. Open a terminal/commmand prompt
2. Navigate to the directory containing the script
3. Run the script
```
python main.py
```

Logs for this script will be written to `scraper.log` in the root directory of the project.

## License
This project is licensed under the MIT License. See `LICENSE` for more information.

## Contact
Christopher Tong - [in/c-tong/](https://www.linkedin.com/in/c-tong/) - christong1114@gmail.com

Project Link: [https://github.com/ct0ng/streamdle-song-scraper.git](https://github.com/ct0ng/streamdle-song-scraper.git)